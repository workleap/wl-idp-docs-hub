<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <meta name="turbo-root" content="/wl-idp-docs-hub">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="4.0.0.825288272228">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 4.0.0">

    <!-- Primary Meta Tags -->
    <title>Setup an update dependencies workflow</title>
    <meta name="title" content="Setup an update dependencies workflow">
    <meta name="description" content="Tired of Renovate Bot? Looking for a smarter way to keep your dependencies up to date? Create a GitHub Action that uses Claude Code to update a project">

    <!-- Canonical -->
    <link rel="canonical" href="https://workleap.github.io/wl-idp-docs-hub/ai/setup-update-dependencies-workflow/">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://workleap.github.io/wl-idp-docs-hub/ai/setup-update-dependencies-workflow/">
    <meta property="og:title" content="Setup an update dependencies workflow">
    <meta property="og:description" content="Tired of Renovate Bot? Looking for a smarter way to keep your dependencies up to date? Create a GitHub Action that uses Claude Code to update a project">
    <meta property="og:site_name" content="Frontend Platform">
    <meta property="og:locale" content="en_US">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link id="retype-favicon" rel="icon" href="../../static/favicon.png" />
    <link href="../../resources/css/retype.css?v=4.0.0.825288272228" rel="stylesheet">

    <script data-cfasync="false" src="../../resources/js/config.js?v=4.0.0.825288272228" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../resources/js/retype.js?v=4.0.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../resources/js/lunr.js?v=4.0.0.825288272228" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../resources/js/prism.js?v=4.0.0.825288272228" defer></script>

    <link href="static/retype-customization.css" rel="stylesheet" />

    <style>
        .agent-extensions th:first-child {
            width: 50% !important;
        }
        .agent-extensions th:nth-child(2) {
            width: 25% !important;
        }
    </style>

</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
    <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>

    <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
        <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
            <!-- Mobile menu button skeleton -->
            <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-hidden rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
            <div v-cloak id="retype-sidebar-left-toggle-button"></div>
    
            <!-- Logo -->
            <div class="flex items-center justify-between h-full py-2 md:w-75">
                <div class="flex items-center px-2 md:px-6">
                    <a id="retype-branding-logo" href="../../" class="flex items-center leading-snug text-xl">
                        <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                            <img class="max-h-10 dark:hidden md:inline-block" src="../../static/logo.png">
                            <img class="max-h-10 hidden dark:inline-block" src="../../static/logo.png">
                        </span>
                        <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">Frontend Platform</span>
                    </a>
                </div>
    
                <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
            </div>
    
            <div class="flex justify-between md:grow">
                <!-- Top Nav -->
                <nav id="retype-header-nav" class="hidden md:flex">
                    <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                        <li class="mr-6">
                            <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="../../">
                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                    <g fill="currentColor">
                                        <path d="M11.03 2.59a1.501 1.501 0 0 1 1.94 0l7.5 6.363a1.5 1.5 0 0 1 .53 1.144V19.5a1.5 1.5 0 0 1-1.5 1.5h-5.75a.75.75 0 0 1-.75-.75V14h-2v6.25a.75.75 0 0 1-.75.75H4.5A1.5 1.5 0 0 1 3 19.5v-9.403c0-.44.194-.859.53-1.144ZM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v6.25h5v-9.403Z"/>
                                    </g>
                                </svg>
                                <span>Home</span>
                            </a>
                        </li>
                        <li class="mr-6">
                            <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://github.com/workleap/wl-idp-docs-hub" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                    <g fill="currentColor">
                                        <path d="M10.303 16.652c-2.837-.344-4.835-2.385-4.835-5.028 0-1.074.387-2.235 1.031-3.008-.279-.709-.236-2.214.086-2.837.86-.107 2.02.344 2.708.967.816-.258 1.676-.386 2.728-.386 1.053 0 1.913.128 2.686.365.666-.602 1.848-1.053 2.708-.946.3.581.344 2.085.064 2.815.688.817 1.053 1.913 1.053 3.03 0 2.643-1.998 4.641-4.877 5.006.73.473 1.224 1.504 1.224 2.686v2.235c0 .644.537 1.01 1.182.752 3.889-1.483 6.94-5.372 6.94-10.185 0-6.081-4.942-11.044-11.022-11.044-6.081 0-10.98 4.963-10.98 11.044a10.84 10.84 0 0 0 7.112 10.206c.58.215 1.139-.172 1.139-.752v-1.719a2.768 2.768 0 0 1-1.032.215c-1.418 0-2.256-.773-2.857-2.213-.237-.58-.495-.924-.989-.988-.258-.022-.344-.129-.344-.258 0-.258.43-.451.86-.451.623 0 1.16.386 1.719 1.181.43.623.881.903 1.418.903.537 0 .881-.194 1.375-.688.365-.365.645-.687.903-.902Z"/>
                                    </g>
                                </svg>
                                <span>Github</span>
                            </a>
                        </li>
    
                    </ul>
                </nav>
    
                <div v-cloak class="flex justify-end grow">
                    <div id="retype-mobile-search-button"></div>
                    <doc-search-desktop></doc-search-desktop>
    
                    <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                    <doc-history></doc-history>
                </div>
            </div>
        </div>
    </header>


    <div id="retype-container" class="container relative flex bg-white">
        <!-- Sidebar Skeleton -->
        <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
        
        
            <div class="pl-6 mt-1 mb-4">
                <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
            </div>
        
        </div>
        
        <!-- Sidebar component -->
        <doc-sidebar v-cloak>
            <template #sidebar-footer>
                <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
        
                    <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                        <nav>
                            <ul class="flex flex-wrap justify-center items-center">
                                <li class="mr-6">
                                    <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="../../">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                            <g fill="currentColor">
                                                <path d="M11.03 2.59a1.501 1.501 0 0 1 1.94 0l7.5 6.363a1.5 1.5 0 0 1 .53 1.144V19.5a1.5 1.5 0 0 1-1.5 1.5h-5.75a.75.75 0 0 1-.75-.75V14h-2v6.25a.75.75 0 0 1-.75.75H4.5A1.5 1.5 0 0 1 3 19.5v-9.403c0-.44.194-.859.53-1.144ZM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v6.25h5v-9.403Z"/>
                                            </g>
                                        </svg>
                                        <span>Home</span>
                                    </a>
                                </li>
                                <li class="mr-6">
                                    <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://github.com/workleap/wl-idp-docs-hub" target="_blank">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                            <g fill="currentColor">
                                                <path d="M10.303 16.652c-2.837-.344-4.835-2.385-4.835-5.028 0-1.074.387-2.235 1.031-3.008-.279-.709-.236-2.214.086-2.837.86-.107 2.02.344 2.708.967.816-.258 1.676-.386 2.728-.386 1.053 0 1.913.128 2.686.365.666-.602 1.848-1.053 2.708-.946.3.581.344 2.085.064 2.815.688.817 1.053 1.913 1.053 3.03 0 2.643-1.998 4.641-4.877 5.006.73.473 1.224 1.504 1.224 2.686v2.235c0 .644.537 1.01 1.182.752 3.889-1.483 6.94-5.372 6.94-10.185 0-6.081-4.942-11.044-11.022-11.044-6.081 0-10.98 4.963-10.98 11.044a10.84 10.84 0 0 0 7.112 10.206c.58.215 1.139-.172 1.139-.752v-1.719a2.768 2.768 0 0 1-1.032.215c-1.418 0-2.256-.773-2.857-2.213-.237-.58-.495-.924-.989-.988-.258-.022-.344-.129-.344-.258 0-.258.43-.451.86-.451.623 0 1.16.386 1.719 1.181.43.623.881.903 1.418.903.537 0 .881-.194 1.375-.688.365-.365.645-.687.903-.902Z"/>
                                            </g>
                                        </svg>
                                        <span>Github</span>
                                    </a>
                                </li>
        
                            </ul>
                        </nav>
                    </div>
                </div>
            </template>
        </doc-sidebar>

        <div class="grow min-w-0 bg-body-bg">
            <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
<div class="flex">
    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
        <main class="relative pb-12 lg:pt-2">
            <div class="retype-markdown" id="retype-content">
                <!-- Rendered if sidebar right is enabled -->
                <div id="retype-sidebar-right-toggle"></div>
                <nav id="retype-breadcrumb" class="breadcrumb" aria-label="Breadcrumb">
                    <ol role="list">
                        <li class="pr-4">
                            <a href="../../ai/" class="pr-4">
                                AI
                            </a>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                            </svg>
                        </li>
                        <li class="pr-4">
                            <a href="../../ai/setup-update-dependencies-workflow/" class="pr-4">
                                Setup update dependencies workflow
                            </a>
                        </li>
                    </ol>
                </nav>

                <!-- Page content  -->
<doc-anchor-target id="setup-an-update-dependencies-workflow" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#setup-an-update-dependencies-workflow">#</doc-anchor-trigger>
        <span>Setup an update dependencies workflow</span>
    </h1>
</doc-anchor-target>
<p>Tired of Renovate Bot? Looking for a smarter way to keep your dependencies up to date? Create a <a href="https://github.com/features/actions" class="outbound" target="_blank">GitHub Action</a> that uses <a href="https://code.claude.com/" class="outbound" target="_blank">Claude Code</a> to update a project dependencies once a week and perform validation tests before opening a pull request.</p>
<blockquote>
<p><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><g><path d="M10.303 16.652c-2.837-.344-4.835-2.385-4.835-5.028 0-1.074.387-2.235 1.031-3.008-.279-.709-.236-2.214.086-2.837.86-.107 2.02.344 2.708.967.816-.258 1.676-.386 2.728-.386 1.053 0 1.913.128 2.686.365.666-.602 1.848-1.053 2.708-.946.3.581.344 2.085.064 2.815.688.817 1.053 1.913 1.053 3.03 0 2.643-1.998 4.641-4.877 5.006.73.473 1.224 1.504 1.224 2.686v2.235c0 .644.537 1.01 1.182.752 3.889-1.483 6.94-5.372 6.94-10.185 0-6.081-4.942-11.044-11.022-11.044-6.081 0-10.98 4.963-10.98 11.044a10.84 10.84 0 0 0 7.112 10.206c.58.215 1.139-.172 1.139-.752v-1.719a2.768 2.768 0 0 1-1.032.215c-1.418 0-2.256-.773-2.857-2.213-.237-.58-.495-.924-.989-.988-.258-.022-.344-.129-.344-.258 0-.258.43-.451.86-.451.623 0 1.16.386 1.719 1.181.43.623.881.903 1.418.903.537 0 .881-.194 1.375-.688.365-.365.645-.687.903-.902Z"/></g></g></svg> For a complete example of this workflow, refer to the <a href="https://github.com/workleap/wl-squide/blob/main/.github/workflows/update-dependencies.yml" class="outbound" target="_blank">Squide repository</a> on GitHub.</p>
</blockquote>
<doc-anchor-target id="install-the-agent-skills">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#install-the-agent-skills">#</doc-anchor-trigger>
        <span>Install the agent skills</span>
    </h2>
</doc-anchor-target>
<p>First, install directly in your project the <a href="https://skills.sh/vercel-labs/agent-browser/agent-browser" class="outbound" target="_blank">agent-browser</a> skill. This skill will help the agent perform the validation steps that requires a browser. To do so, open a terminal at the root of the workspace and execute the following command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-bash"><code v-pre class="language-bash">pnpx skills add https://github.com/vercel-labs/agent-browser --skill agent-browser</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="create-the-prompt-file">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#create-the-prompt-file">#</doc-anchor-trigger>
        <span>Create the prompt file</span>
    </h2>
</doc-anchor-target>
<p>Then, create a <code translate="no" v-pre>.github/prompts/update-dependencies.md</code> with the following content, and adjust the validation steps to match your project&#x27;s capabilities:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">.github/prompts/update-dependencies.md</div>
<pre translate="no" class="language-markdown"><code v-pre class="language-markdown"># Update Dependencies

You are an automated agent responsible for updating the dependencies of this monorepo and validating that everything still works correctly.

## Constraints

- You have a maximum of **10 attempts** to pass all validation steps. If you exhaust all attempts, go to Step 4 (Failure).
- You MUST execute every validation step (2a, 2b, 2c, 2d) in order. Do NOT skip any step.
- Do NOT create new source files as part of a dependency update. Only modify existing files when migrating to a newer API.
- **Avoid rabbit holes**: If you spend more than 3 attempts or 10 tool calls investigating a single issue without progress, stop. Revert the problematic package to its previous version, open an issue, and move on.

---

## Step 1: Update dependencies

Update all dependencies to their latest versions:

```bash
pnpm update-outdated-deps
```

Then, check if any `package.json` files were modified:

```bash
git diff --name-only -- '**/package.json' ':!node_modules'
```

If the output is empty, there are no dependency updates. STOP immediately. You are done.

Otherwise, install the updated dependencies:

```bash
pnpm install --no-frozen-lockfile
```

## Step 2: Validation loop

Run steps 2a through 2d in order. If ANY step fails, diagnose and fix the issue before retrying. Read error messages carefully, inspect failing source code, look up changelogs or migration guides for packages with breaking changes, then apply the fix and restart from Step 2a.

**When fixing breaking changes:**

- Migrate code to use the newer API or pattern introduced by the updated package.
- Do NOT add polyfills, shims, or workarounds for features already available in the runtime.
- Do NOT patch or monkey-patch libraries to suppress errors.
- If a breaking change cannot be resolved by a clean migration, revert that specific package to its previous version, open an issue using the template below, then continue with the remaining updates.

```bash
gh issue create \
  --title &quot;[agent] Failed to update &lt;package-name&gt;&quot; \
  --body &quot;## Failed dependency update

**Package**: \`&lt;package-name&gt;\`
**From**: \`&lt;old-version&gt;\` → **To**: \`&lt;new-version&gt;\`

## Error

&lt;Error messages and which validation step failed&gt;

## What was tried

&lt;Brief description of migration attempts&gt;

## Workflow run

$GITHUB_SERVER_URL/$GITHUB_REPOSITORY/actions/runs/$GITHUB_RUN_ID&quot;
```

### Step 2a: Linting

```bash
pnpm lint
```

All checks must pass with zero errors.

### Step 2b: Tests

```bash
pnpm test
```

All tests must pass. If a test fails, run the failing package's tests directly (e.g., `pnpm --filter &lt;package&gt; test`) to get clearer output instead of re-running the full suite.

### Step 2c: Validate the &quot;endpoints&quot; sample app

Use `pnpx agent-browser` for all browser interactions in this step. Read the locally installed agent skill at `.agents/skills/agent-browser/` to learn the available commands. **Important**: the skill examples use bare `agent-browser` commands, but you MUST always prefix with `pnpx` (e.g., `agent-browser open &lt;url&gt;` becomes `pnpx agent-browser open &lt;url&gt;`). Running a build is NOT sufficient — you must start the dev server and validate in a real browser.

1. Start the dev server in the background using the shell `&amp;` operator (do NOT use `run_in_background: true`): `pnpm dev-endpoints &gt; /tmp/endpoints-dev.log 2&gt;&amp;1 &amp;`
2. The endpoints app listens on port **8080**. Wait for it to be ready — do NOT use `sleep`, do NOT write polling loops, do NOT parse the log file for a URL. Instead, immediately run: `curl --retry 30 --retry-delay 5 --retry-connrefused --silent --output /dev/null http://localhost:8080`
3. The app has a mock login page. Use username `temp` and password `temp` to authenticate.
4. Navigate to the following pages and check that each renders without errors:
   - `/` (Home page)
   - `/subscription`
   - `/federated-tabs`
   - `/federated-tabs/episodes`
   - `/federated-tabs/locations`
5. For each page, use `pnpx agent-browser snapshot` to verify the page rendered content, and use `pnpx agent-browser console` to check for console errors (ignore warnings and known noise like network errors from fake APIs or MSW)
6. Stop the dev server process when done: `kill $(lsof -t -i:8080) 2&gt;/dev/null || true; fuser -k 8080/tcp 2&gt;/dev/null || true`

### Step 2d: Validate the &quot;storybook&quot; sample app

Use `pnpx agent-browser` for all browser interactions in this step. Read the locally installed agent skill at `.agents/skills/agent-browser/` to learn the available commands. **Important**: the skill examples use bare `agent-browser` commands, but you MUST always prefix with `pnpx` (e.g., `agent-browser open &lt;url&gt;` becomes `pnpx agent-browser open &lt;url&gt;`). Running a build is NOT sufficient — you must start the dev server and validate in a real browser.

1. Start the dev server in the background using the shell `&amp;` operator (do NOT use `run_in_background: true`): `pnpm dev-storybook &gt; /tmp/storybook-dev.log 2&gt;&amp;1 &amp;`
2. The storybook app listens on port **6006**. Wait for it to be ready — do NOT use `sleep`, do NOT write polling loops, do NOT parse the log file for a URL. Instead, immediately run: `curl --retry 30 --retry-delay 5 --retry-connrefused --silent --output /dev/null http://localhost:6006`
3. Navigate to http://localhost:6006 and verify it loads correctly
4. Click on at least **2 different stories** in the sidebar and verify each renders without errors. Use `pnpx agent-browser snapshot` to verify the rendered content and `pnpx agent-browser console` to check for console errors (ignore warnings and known noise)
5. Stop the dev server process when done: `kill $(lsof -t -i:6006) 2&gt;/dev/null || true; fuser -k 6006/tcp 2&gt;/dev/null || true`

## Step 3: Success

All validations passed.

### 3a: Create a changeset (if needed)

Only include `@squide/*` packages whose `dependencies` or `peerDependencies` have actually changed. Do NOT include packages where only `devDependencies` changed — devDependency-only changes do not affect the published package. If no `@squide/*` packages qualify (i.e., every change is devDependency-only), skip this step entirely — do NOT create a changeset file.

Create a changeset file at `.changeset/update-deps-&lt;YYYYMMDD-HHMMSS&gt;.md` (use the current UTC date-time to avoid filename collisions with unreleased changesets). Use `patch` as the default bump level, but use your judgment to bump as `minor` or `major` if warranted by the dependency changes.

Example format:

```markdown
---
&quot;@squide/core&quot;: patch
---

Updated dependencies to their latest versions.
```

### 3b: Commit and create pull request

Close any existing open dependency-update PRs before creating a new one:

```bash
gh pr list --search &quot;chore: update dependencies&quot; --state open --json number --jq '.[].number' | xargs -I{} gh pr close {} --comment &quot;Superseded by a newer dependency update run.&quot;
```

Then create the new PR with the body described below.

#### How to write the Summary section

Before writing the summary, run `git diff main -- '**/package.json'` to see the actual changes. Then apply these rules:

1. In unified diff output, context lines start with a SPACE character, removed lines start with a single `-`, and added lines start with a single `+`. Only `-` and `+` lines represent actual changes — do NOT include dependencies that only appear on space-prefixed context lines.
2. Deduplicate: list each dependency name + version change only once, even if it appears in multiple package.json files.
3. If a dependency appears in different categories across packages (e.g., peerDependencies in a library and devDependencies in a sample), list all categories it belongs to (e.g., &quot;peerDependencies, devDependencies&quot;).
4. Format each as: `package-name`: `old-version` → `new-version` (category), where category is dependencies, peerDependencies, or devDependencies.
5. Sort by category priority: peerDependencies first, then dependencies, then devDependencies. If a dependency belongs to multiple categories, sort it by its highest-priority category.
6. Highlight any peerDependency range narrowing with &quot;(range narrowed — may break consumers)&quot; — these affect consumers.
7. Do NOT mention transitive dependencies (pnpm-lock.yaml only).

#### PR body template

```markdown
## Summary

&lt;list the updated dependencies here, following the rules above&gt;

## Validation checklist
- [x] Step 2a: Linting
- [x] Step 2b: Tests
- [x] Step 2c: Endpoints sample app
- [x] Step 2d: Storybook sample app
```

#### Create the PR

```bash
BRANCH_NAME=&quot;agent/update-deps-$(date -u +%Y%m%d-%H%M%S)&quot;
git checkout -b &quot;$BRANCH_NAME&quot;
git add -A
git commit -m &quot;chore: update dependencies&quot;
git push origin &quot;$BRANCH_NAME&quot;

gh pr create \
  --base main \
  --head &quot;$BRANCH_NAME&quot; \
  --title &quot;chore: update dependencies $(date -u +%Y-%m-%d)&quot; \
  --body &quot;&lt;use the PR body template above&gt;&quot;
```

Then STOP. You are done.

## Step 4: Failure

You have exhausted 10 validation attempts. Do NOT create a pull request.

```bash
gh issue create \
  --title &quot;[agent] Cannot update dependencies&quot; \
  --body &quot;&lt;Include: which step(s) failed, error messages, what fixes were attempted, and a link to: $GITHUB_SERVER_URL/$GITHUB_REPOSITORY/actions/runs/$GITHUB_RUN_ID&gt;&quot;
```

Then STOP. You are done.</code></pre>
</doc-codeblock></div>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-tip"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-tip" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M7.90625 2.15625C4.50944 2.15625 2.15625 4.58563 2.15625 7.54688C2.15625 8.96138 2.76575 9.88281 3.57075 10.8589L3.87837 11.2226C4.19894 11.6021 4.554 12.0218 4.84581 12.4416C5.25406 13.0324 5.61775 13.7296 5.7385 14.5834C5.76728 14.8608 5.68746 15.1386 5.51579 15.3583C5.34413 15.5781 5.09399 15.7228 4.8179 15.7621C4.5418 15.8013 4.26124 15.7321 4.03512 15.5689C3.809 15.4056 3.65493 15.1612 3.60525 14.8867C3.54775 14.4814 3.37094 14.1004 3.07338 13.6692C2.8306 13.3302 2.57055 13.0039 2.29425 12.6917C2.1735 12.5479 2.04556 12.397 1.909 12.2317C1.00769 11.1406 0 9.72613 0 7.54688C0 3.32062 3.39681 0 7.90625 0C12.4157 0 15.8125 3.32062 15.8125 7.54688C15.8125 9.72613 14.8048 11.1406 13.9035 12.2317C13.7669 12.397 13.639 12.5479 13.5183 12.6903C13.2207 13.0424 12.9677 13.3414 12.7406 13.6692C12.4416 14.1004 12.2662 14.4814 12.2087 14.8867C12.1557 15.1584 12.0003 15.3994 11.7747 15.5598C11.5492 15.7202 11.2706 15.7879 10.9965 15.7488C10.7225 15.7096 10.474 15.5667 10.3023 15.3496C10.1306 15.1325 10.0489 14.8577 10.074 14.582C10.1948 13.7296 10.5584 13.0324 10.9667 12.4416C11.2585 12.0218 11.6136 11.6021 11.9341 11.2226C12.0419 11.0961 12.1454 10.9739 12.2403 10.8589C13.0468 9.88281 13.6562 8.96138 13.6562 7.54688C13.6562 4.58563 11.3031 2.15625 7.90625 2.15625ZM4.67188 17.25H11.1406C11.4266 17.25 11.7008 17.3636 11.903 17.5658C12.1052 17.768 12.2188 18.0422 12.2188 18.3281C12.2188 18.6141 12.1052 18.8883 11.903 19.0905C11.7008 19.2927 11.4266 19.4062 11.1406 19.4062H4.67188C4.38594 19.4062 4.11171 19.2927 3.90953 19.0905C3.70734 18.8883 3.59375 18.6141 3.59375 18.3281C3.59375 18.0422 3.70734 17.768 3.90953 17.5658C4.11171 17.3636 4.38594 17.25 4.67188 17.25ZM5.03125 21.9219C5.03125 21.6359 5.14484 21.3617 5.34703 21.1595C5.54921 20.9573 5.82344 20.8438 6.10938 20.8438H9.70312C9.98906 20.8438 10.2633 20.9573 10.4655 21.1595C10.6677 21.3617 10.7812 21.6359 10.7812 21.9219C10.7812 22.2078 10.6677 22.482 10.4655 22.6842C10.2633 22.8864 9.98906 23 9.70312 23H6.10938C5.82344 23 5.54921 22.8864 5.34703 22.6842C5.14484 22.482 5.03125 22.2078 5.03125 21.9219Z" />
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>If the project is not a library, remove the <code translate="no" v-pre>3a: Create a changeset</code> step.</p>
        </div>
    </div>
</div>
<doc-anchor-target id="create-the-workflow-file">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#create-the-workflow-file">#</doc-anchor-trigger>
        <span>Create the workflow file</span>
    </h2>
</doc-anchor-target>
<p>Then, create a <code translate="no" v-pre>.github/workflows/update-dependencies.yml</code> file for the GitHub action:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">.github/workflows/update-dependencies.yml</div>
<pre translate="no" class="language-yaml"><code v-pre class="language-yaml">name: Update dependencies

on:
  schedule:
    - cron: &quot;0 14 * * 2&quot;
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write
  issues: write
  id-token: write

concurrency:
  group: update-dependencies
  cancel-in-progress: true

jobs:
  update-dependencies:
    runs-on: ubuntu-latest
    timeout-minutes: 60
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install pnpm
        uses: pnpm/action-setup@v4
        with:
          run_install: false

      - name: Install Node.js
        uses: actions/setup-node@v6
        with:
          node-version: &quot;&gt;=24.0.0&quot;
          check-latest: true
          cache: pnpm
          cache-dependency-path: pnpm-lock.yaml

      - name: Install browser dependencies
        run: pnpx agent-browser install --with-deps

      - name: Warm up browser
        run: |
          pnpx agent-browser open about:blank
          pnpx agent-browser close

      - name: Update dependencies
        uses: anthropics/claude-code-action@v1
        with:
          prompt: |
            Read and follow the instructions in .github/prompts/update-dependencies.md
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          show_full_output: true
          claude_args: &gt;-
            --max-turns 200
            --allowedTools Edit,Read,Write,Glob,Grep,Bash(pnpm:*),Bash(git:*),Bash(node:*),Bash(gh:*),Bash(pnpx agent-browser:*),Bash(agent-browser:*),Bash(kill:*),Bash(lsof:*),Bash(curl:*),Bash(fuser:*)
        env:
          # Required by gh CLI to create PRs and issues.
          GH_TOKEN: ${{ github.token }}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="try-it-rocket">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#try-it-rocket">#</doc-anchor-trigger>
        <span>Try it <span class="docs-emoji">&#x1F680;</span></span>
    </h2>
</doc-anchor-target>
<p>Push the GitHub Action and manually trigger the workflow. Once it completes, the workflow will either open a pull request if new dependency versions are found or create an issue if it fails.</p>
<div id="retype-backlinks">
    <h2>See also</h2>
    <div class="grid gap-4 [grid-template-columns:repeat(auto-fit,minmax(300px,1fr))]">
        <a href="/wl-idp-docs-hub/ai/" class="group no-link">
            <div class="flex flex-col">
                <div>
                    <span>AI</span>
                </div>
                <p>Setup agent extensions</p>
            </div>
        </a>
    </div>
</div>

                
                <!-- Required only on API pages -->
                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
            </div>
            <footer id="retype-content-footer" class="clear-both">
                <div class="flex flex-wrap items-center justify-between mt-14">
                    <a id="retype-edit-this-page" class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-body-link font-body-link hover:text-body-link-hover hover:underline" href="https://github.com/workleap/wl-idp-docs-hub/blob/main/docs/ai/setup-update-dependencies-workflow.md" target="_blank" rel="noopener">
                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                        <span>Edit this page</span>
                    </a>
                </div>
            
                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                    <div class="w-1/2">
                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../ai/setup-code-review-workflow/">
                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                            <span>
                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                <span class="block mt-1">Setup code review workflow</span>
                            </span>
                        </a>
                    </div>
            
                    <div class="w-1/2">
                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../ai/setup-audit-monorepo-workflow/">
                            <span>
                                <span class="block text-xs font-normal text-right text-base-text-muted">Next</span>
                                <span class="block mt-1">Setup audit monorepo workflow</span>
                            </span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                        </a>
                    </div>
                </nav>
            </footer>
        </main>

        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                <div id="retype-footer-links" class="print:hidden">
                    <ul class="flex flex-wrap items-center text-sm">
                    </ul>
                </div>
                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link text-sm leading-relaxed"><p>© Copyright 2026 - Workleap</p></div>
            </footer>
        </div>
    </div>

    <!-- Rendered if sidebar right is enabled -->
    <!-- Sidebar right skeleton-->
    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:translate-x-0 sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
        <div class="pl-5">
            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
        </div>
    </div>

    <!-- User should be able to hide sidebar right -->
    <doc-sidebar-right v-cloak></doc-sidebar-right>
</div>

        </div>
    </div>

    <doc-search-mobile></doc-search-mobile>
    <doc-back-to-top></doc-back-to-top>
</div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Setup update dependencies workflow", level: 2, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 2 }</script>
</body>
</html>
